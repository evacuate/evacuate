#!/bin/sh

echo "ğŸ” Running pre-push checks..."

# ã‚³ãƒŸãƒƒãƒˆãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã®@pre-pushãƒã‚§ãƒƒã‚¯
echo "ğŸ“ Checking @pre-push tag..."
commit_message=$(git log -1 --pretty=%B)
if ! echo "$commit_message" | grep -q "@pre-push"; then
    echo "âŒ Error: Commit message must include @pre-push tag"
    exit 1
fi
echo "âœ… @pre-push tag check passed"

# å‹ãƒã‚§ãƒƒã‚¯
echo "ğŸ“˜ Running type check..."
if ! npm run typecheck; then
    echo "âŒ Type check failed"
    exit 1
fi
echo "âœ… Type check passed"

# Biomeãƒã‚§ãƒƒã‚¯
echo "ğŸ§¹ Running Biome checks..."
if ! npm run check; then
    echo "âŒ Biome check failed"
    exit 1
fi
echo "âœ… Biome check passed"

# ãƒ†ã‚¹ãƒˆãƒã‚§ãƒƒã‚¯
echo "ğŸ§ª Running tests..."
if ! npm run test; then
    echo "âŒ Test failed"
    exit 1
fi
echo "âœ… Test check passed"

# ãƒ“ãƒ«ãƒ‰ãƒã‚§ãƒƒã‚¯
echo "ğŸ—ï¸ Running build check..."
if ! npm run build; then
    echo "âŒ Build failed"
    exit 1
fi
echo "âœ… Build check passed"

echo "âœ… All checks passed! Ready to push." 